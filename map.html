<!DOCTYPE html>
<!doctype html>
<html style="width: 100%; height: 100%">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1, user-scalable=no">

    <title>MTBAtlanta.com - Mountain Biking Destinations in Atlanta, GA</title>
    <meta name="keywords" content="{{ pkg.keywords.join(',') }}">
    <meta name="description" content="{{ pkg.description }}">
    <link href="img/apple-touch-icon-180x180.png" rel="apple-touch-icon" sizes="180x180" />
<link href="img/icon-hires.png" rel="icon" sizes="192x192" />

      <link type="text/css" href="/css/layout.css" rel="stylesheet" />
      <link type="app/css" href="/css/app.css" rel="stylesheet" />

      <!-- Include jQuery.mmenu .css files -->
      <link type="text/css" href="/css/jquery.mmenu.all.css" rel="stylesheet" />

      <link rel="stylesheet" href="css/bootstrap.min.css">
    
    <!-- icons -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

      <!-- Include jQuery and the jQuery.mmenu .js files -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>    
    <script type="text/javascript" src="/js/jquery.mmenu.min.all.js"></script>
		<link rel="stylesheet" type="text/css" href="css/style5.css" />
  		<script src="js/modernizr.custom.js"></script>
      
    <script src="http://maps.google.com/maps/api/js?key=AIzaSyB1gUeLFFAWuEDL4kpP7XQ3WsaEyg2evbg" 
          type="text/javascript"></script>
          
    <script src="js/markerwithlabel_packed.js" type="text/javascript"></script>
    
 <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-542e08e37a73f7d6"></script>


      <!-- Fire the plugin onDocumentReady -->
 <script type="text/javascript">
  var showSplash = function() {
      var contentString = $("#splash").html();
      $("#trailinfo").html(contentString);
      toggleOverlay();
  }
  
  var openSite = function(me) {
      var id = $(me).attr("name");
      contentString = $("#" + id).html();
      $("#trailinfo").html(contentString);
      $("#traillist").trigger("close.mm");
      toggleOverlay();
  }
  
  var showDriveMenu = function() {
      $("#traillist").trigger("open.mm");
  }
  
  var showMapMenu = function() {
      $("#menu").trigger("open.mm");
  }
  
  var showSites = function() {
      var all = $("#togAll").is(":checked");
      var allDir = true; //$("#togDirAll").is(":checked");
      var close = $("#togClose").is(":checked");
      var far = $("#togFar").is(":checked");
      var north = $("#togNorth").is(":checked");
      var east = $("#togEast").is(":checked");
      var west = $("#togWest").is(":checked");
      var south = $("#togSouth").is(":checked");
      var shops = $("#togShops").is(":checked");
      
    var locations = [
      {% for site in sites %}
          ['{{ site.name }}', {{ site.lat }}, {{ site.long }}, '{{ site.side }}', '{{ site.address }}', 
          '{{ site.web }}', '{{ site.id }}', {{ site.mileage }}, '{{site.abbr}}', '{{ site.far }}',
          '{{ site.closed }}', '{{ site.color }}']
          {% if !loop.last %},{% endif %}
      {% endfor %}
    ];

    var map = new google.maps.Map(document.getElementById('map'), {
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      panControl: false,
      mapTypeControl: false,
      scaleControl: false,
      streetViewControl: false,
      overviewMapControl: false,
      zoomControl: true,
                zoomControlOptions: {
                    
                    position: google.maps.ControlPosition.LEFT_BOTTOM
                }
    });

    map.set('styles', [
      {
        "featureType": "road",
        "stylers": [
          { "visibility": "simplified" }
        ]
      }
    ]);

    var infowindow = new google.maps.InfoWindow();
    var bounds = new google.maps.LatLngBounds();

    var marker, i;

    for (i = 0; i < locations.length; i++) {  
      if (locations[i][9] == 'Y' && far || locations[i][9] != 'Y' && close || all) {
          var side = locations[i][3];
          if (allDir || all || (side == 'N' && north) || (side == 'E' && east) || (side == 'S' && south) || (side == 'W' && west)) {
              var position =  new google.maps.LatLng(locations[i][1], locations[i][2]);

              bounds.extend(position);

             var icon = 'lilpin.png';
             /*if (locations[i][10] == 'Y') {
                 icon = 'free-map-marker-icon-orange.png';      
             }*/
             
             var xoff=12;
             var yoff=40;
             var abb = locations[i][8];
             switch (abb) {
                 case 'ROP':
                     xoff = 12;
                     break;
                 case 'DUP':
                     xoff = 7;
                     yoff = 34;
                     break;
                 case 'BLK':
                     yoff=48;
                     break;
                 case 'TRM':
                     xoff=16;
                     break;
                 case 'HAR':
                     xoff=8;
                     break;
                 case 'CEN':
                     xoff=16;
                     break;
                 case 'CHL':
                     xoff=8;
                     break;
                 case 'BCK':
                     xoff=16;
                     break;
                 case 'MTA':
                     xoff=8;
                     break;
                 default:
                     break;
             }
            


             marker = new MarkerWithLabel({
               icon: '/img/markers/' + icon,
               position: position,
               draggable: false,
               map: map,
               labelContent: locations[i][8] + '<br>' +locations[i][7],
               labelAnchor: new google.maps.Point(xoff, yoff),
               labelClass: "maplabels3", // the CSS class for the label
               labelStyle: {opacity: 1, backgroundColor: '#' + locations[i][11]},
               labelInBackground: false,
               title: locations[i][0] + '\nClick for more'
             });  
        


              google.maps.event.addListener(marker, 'click', (function(marker, i) {
                return function() {
                  contentString = $("#" + locations[i][6]).html();
                  //infowindow.setContent(contentString);
                  //infowindow.open(map, marker);
                  $("#trailinfo").html(contentString);
                  toggleOverlay();
                  //$("#trails").trigger("open.mm");
                }
              })(marker, i));
            }
        }
    }
    
    map.fitBounds(bounds);
    };
    

  </script>
      <script type="text/javascript">
         $(document).ready(function() {
            $("#menu").mmenu({
               "footer": {
                  "add": false,
                  "title": "MTBAtlanta.com"
               },
               "header": false,
               "searchfield": false,
               "classes": "mm-light",
               slidingSubmenus: false
            });
            
            $("#traillist").mmenu({
                "header": {
                  "title": "Drive to:",
                  "add": true,
                  "update": true
               },
                offCanvas: {
                    position	: 'right'
                },
		        classes		: 'mm-light'
            });
            

            $(".togTrails").click(showSites);
            
            
            showSites();


         });
      </script>

   </head>
   <body style="width: 100%; height: 100%">

      <!-- The page -->
      <div class="page" style="width: 100%; height: 100%; padding: 0px; margin: 0px;">

         <!-- <div class="header">
            <a href="#menu"></a>
            MTBAtlanta
            <a href="#traillist" class="friends right"></a>
         </div> -->
        <div class="content" style="width: 100%; height: 100%; padding: 0px; margin: 0px;">
              <div class="oo-overlay oo-overlay-scale">
                <button type="button" class="oo-overlay-close">Close</button>
                <div id="trailinfo"></div>
            </div> 
               <div id="map" style="width: 100%; height: 100%; padding: 0px; margin: 0px;"></div>
       <button type="button" onclick="showMapMenu();" class="btn btn-primary btn-sm" style="position: fixed; top: 5px; left: 5px; z-index: 99;">
        <i class="fa fa-gear"></i>
      </button>
      <ul class="dropdown-menu" role="menu" style="position: fixed; top: 3em; left: 5px">
        <li><a id="north">NorthSide</a></li>
        <li><a  id="east">EastSide</a></li>
        <li><a  id="west">WestSide</a></li>
        <li><a  id="south">SouthSide</a></li>
        <li class="divider"></li>
        <li><a id="all">All</a></li>
      </ul>
      <button type="button" class="btn btn-primary btn-sm" onclick="showDriveMenu();" style="position: fixed; top: 5px; right: 5px; z-index: 99;">
        <i class="fa fa-car"></i>
      </button>
      <button type="button" class="btn btn-primary btn-sm" onclick="showSplash();" style="position: fixed; bottom: 5px; right: 5px; z-index: 99;">
        <i class="fa fa-info-circle"></i>
      </button>
    </div>
         </div>
      </div>

      <!-- The menu -->
      <nav id="menu">
         <ul>

            <li><a href="" onclick="return false;">All Trails</a>
               <input name="togTrails" id="togAll" type="radio" class="Toggle togTrails" />
            </li>
            <li>
                <a href="" onclick="return false;">Close-in Trails</a>
               <input name="togTrails" id="togClose" type="radio" class="Toggle togTrails" checked />
              </li>
            <li><a href="" onclick="return false;">Day Trips</a>
               <input name="togTrails" id="togFar" type="radio" class="Toggle togTrails" />
            </li>
                <!--    <li><a href="" onclick="return false;">All Directions</a>
                   <input name="togDir" id="togDirAll" type="radio" class="Toggle togTrails" checked /></li>
                   <li><a href="" onclick="return false;">North</a>
                   <input name="togDir" id="togNorth" type="radio" class="Toggle togTrails"  /></li>
                   <li><a href="" onclick="return false;">East</a>
                   <input name="togDir" id="togEast" type="radio" class="Toggle togTrails"  /></li>
                   <li><a href="" onclick="return false;">South</a>
                   <input name="togDir" id="togSouth" type="radio" class="Toggle togTrails"  /></li>
                   <li><a href="" onclick="return false;">West</a>
                   <input name="togDir" id="togWest" type="radio" class="Toggle togTrails"  /></li> -->

            <!-- <li><a href="">Bike Shops</a>
               <input id="togShop" type="checkbox" class="Toggle togTrails" /></li> -->
         </ul>
      </nav>
      
     <nav id="traillist">
         <ul>
         {% for site in sites %}
              <li><a target= "_blank" href="http://maps.google.com/maps?daddr={{ site.address }}">{{ site.name }}</a></li>
          {% endfor %}
         </ul>
     </nav>
      
 <script type="text" id="splash">
     <div style="text-align: center; vertical-align: middle;">
        <h1>MTBAtlanta.com</h1>
        <p>Atlanta Mountain Bike Trails</p>
        <a href="mailto:iestyn.lewis@gmail.com">iestyn.lewis@gmail.com</a>
        <br>
        <!-- Go to www.addthis.com/dashboard to customize your tools -->
        <!-- <div class="addthis_sharing_toolbox"></div> -->
        <!-- <img src="img/background.jpg"> -->
        <!--<p class="pull-right" style="text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;">Mountain Biking Destinations in and around Atlanta, GA</p>-->
     </div>
 </script>
 
  {% for site in sites %}
      <script type=text id='{{ site.id }}'>
       {% include 'site-min.html' %}
      </script>
  {% endfor %}
  		<script src="js/classie.js"></script>
		<script src="js/demo1.js"></script>
            <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54484504-2', 'auto');
  ga('send', 'pageview');

</script>
   </body>
</html>